var container=document.getElementsByClassName("wm-modal-btn-container"),click2shipJSHost="http://crossbordertrade.github.io/click2ship";if(void 0!==container&&container.length>0){var createShipmentButton;console.log("container :"+container);var buttonContainer=container[0];if(1==buttonContainer.getElementsByClassName("wm-btn-primary ").length){(createShipmentButton=document.createElement("Button")).innerHTML="Create Shipment",createShipmentButton.id="create-shipment-button",createShipmentButton.className="wm-btn-primary mgn-lft progress-btn c2sCreateShipmentButton",createShipmentButton.disabled=!1,buttonContainer.appendChild(createShipmentButton);var imported=document.createElement("script");imported.src=click2shipJSHost+"/javascript/formPopUp.js?x="+Math.random(),document.head.appendChild(imported)}createShipmentButton.onclick=function(){createDialog(),$("#api-response").text(""),getItemDetails()};var result=[],filteredArr=[];function getItemDetails(){$($(".ui-grid-canvas")[1]).find("input[type=checkbox]").each(function(e,t){var r=$($($(t).parent().parent().parent()).children()[3]).children().text(),n=$($($(t).parent().parent().parent()).children()[8]).children().find(":selected").text(),i=$($($(t).parent().parent().parent()).children()[2]).children().text(),a=$($($(t).parent().parent().parent()).children()[2]).children().find("img").attr("src"),o=$($($(t).parent().parent().parent()).children()[1]).children().text(),c={sku:r,prodName:i,prodSrc:a,UPC:o,status:n};!0===$(this).prop("checked")?"Acknowledged"===n&&result.push(c):result.length&&result.forEach(function(e,t,n){e.sku!==r||n.splice(t,1)})}),filteredArr=result.reduce(function(e,t){return e.find(e=>e.sku===t.sku)?e:e.concat([t])},[]),console.log("final array click2Ship:",filteredArr);var e="";filteredArr.forEach(function(t,r,n){e+="<div class= 'image-box'>",e+="<img src="+filteredArr[r].prodSrc+" class= '' />",e+="<div>",e+="<div><p>"+filteredArr[r].prodName+"</p></div>",e+="<div><p>UPC: "+filteredArr[r].UPC+"</p></div>",e+="</div>",e+="</div>"}),$("#productImage").html(e),$("#selected_items_count").text("("+filteredArr.length+" item(s))"),"undefined"!=typeof Storage?localStorage.setItem("filteredArr",JSON.stringify(filteredArr)):alert("Sorry, your browser does not support Web Storage..."),filteredArr.length?(document.getElementsByClassName("wm-main-wrapper")[0].style.display="none",dialog.dialog("open"),$(".ui-dialog-titlebar-close")[0].remove()):alert("Please select at least order line whose status is in Acknowledged ")}}
